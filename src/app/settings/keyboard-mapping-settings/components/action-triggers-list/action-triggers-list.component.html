<div class="c-action-triggers-list">
  <div class="c-action-triggers-list__search">
    <input type="text" [(ngModel)]="search" placeholder="Search" />
    <ng-container *ngIf="selectMode; else turnOnSelectModeButton">
      <sofie-dropdown-button
        [options]="selectedActionTriggerOptions"
        [iconButton]="IconButton.SQUARE_CHECK"
        [iconButtonSize]="IconButtonSize.XL"
        (onSelect)="applyUserActionToSelectedActionTriggers($event)"
        label="Selected">
      </sofie-dropdown-button>
      <sofie-button (click)="setSelectMode(false)">Disable multiselect</sofie-button>
    </ng-container>

    <ng-template #turnOnSelectModeButton>
      <sofie-dropdown-button
        [selectedKey]="sortQuery"
        [options]="sortActionsTriggers"
        [label]="sortLabel"
        [iconButton]="IconButton.VERTICAL_OPPOSING_TRIANGLES"
        [iconButtonSize]="IconButtonSize.XL"
        (onSelect)="applySortQuery($event)">
      </sofie-dropdown-button>

      <sofie-button (click)="setSelectMode(true)">Enable multiselect</sofie-button>
    </ng-template>
  </div>
  <div class="c-action-triggers-list__items">
    <ng-container *ngIf="actionTriggersWithAction">
      <ng-container *ngIf="filteredActionsTriggers.length !== 0; else noItemsFound">
        <ng-container *ngFor="let actionTriggerWithActions of filteredActionsTriggers; let i = index">
          <div
            *ngIf="actionTriggerWithActions.actionTrigger as actionsTrigger"
            class="c-action-triggers-list__card c-sofie-card"
            [ngClass]="{ 'c-action-triggers-list__card--selected': selectedActionTrigger && selectedActionTrigger.actionTrigger.id && selectedActionTrigger.actionTrigger.id === actionsTrigger.id }">
            <sofie-checkbox
              *ngIf="selectMode"
              [isSelected]="isActionTriggerSelected(actionsTrigger.id)"
              (onToggle)="setActionTriggerSelection(actionsTrigger.id, $event)"></sofie-checkbox>
            <div class="c-action-triggers-list__card--body" (click)="selectActionTrigger(actionTriggerWithActions)">
              <p>
                {{ actionsTrigger.data.label }}
              </p>
              <div>
                  <sofie-rounded-box class="me-2">
                      {{ (actionsTrigger.data.mappedToKeys && actionsTrigger.data.mappedToKeys.length > 0 ? actionsTrigger.data.mappedToKeys! : actionsTrigger.data.keys) | formatKeyboardKeys }}
                  </sofie-rounded-box>
                  <sofie-rounded-box class="{{ actionTriggerWithActions.action.metadata.contentType | actionColor }}">
                      {{ actionTriggerWithActions.action.name }}
                  </sofie-rounded-box>
              </div>
            </div>
            <div *ngIf="!selectMode" class="c-action-triggers-list__card--actions">
              <sofie-icon-button
                [iconButton]="IconButton.PEN"
                tooltip="Edit action trigger"
                [iconButtonSize]="IconButtonSize.L"
                (click)="selectActionTrigger(actionTriggerWithActions)"></sofie-icon-button>
              <sofie-icon-button [iconButton]="IconButton.TWO_SHEETS_COPY" tooltip="Copy action trigger" [iconButtonSize]="IconButtonSize.L" (click)="cloneActionTrigger(actionTriggerWithActions)">
              </sofie-icon-button>
              <sofie-icon-button [iconButton]="IconButton.TRASH_CAN" tooltip="Delete action trigger" [iconButtonSize]="IconButtonSize.L" (click)="openDeleteActionTriggerDialog(actionsTrigger.id)">
              </sofie-icon-button>
            </div>
          </div>
        </ng-container>
      </ng-container>
      <ng-template #noItemsFound>
        <div class="c-action-triggers-list__no-items c-sofie-card">
          <h3 i18n>action-triggers.no-shortcuts.label</h3>
        </div>
      </ng-template>
    </ng-container>
  </div>
</div>
