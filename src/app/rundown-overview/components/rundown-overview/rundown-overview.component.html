<sofie-header></sofie-header>

<h1 class="c-rundown-overview__title" i18n>rundown-overview-component.rundown-header.label</h1>

<div *ngIf="isLoading; else doneLoading" class="c-rundown-overview__loading-rundowns">
  <mat-card-title i18n>rundown-overview-component.loading-rundowns.message</mat-card-title>
</div>

<ng-template #doneLoading>
  <div *ngIf="basicRundowns.length === 0; else rundowns" class="c-rundown-overview__no-rundowns">
    <h2 i18n>rundown-overview-component.no-rundowns-available.message</h2>
    <p i18n>rundown-overview-component.check-connection-configure-ingest-gateway.message</p>
  </div>
</ng-template>

<ng-template #rundowns>
  <table *ngIf="!isLoading && basicRundowns.length > 0" mat-table [dataSource]="basicRundowns">
    <ng-container matColumnDef="status">
      <mat-header-cell *matHeaderCellDef></mat-header-cell>
      <mat-cell *matCellDef="let basicRundown" >
        <sofie-pulsating-dot *ngIf="basicRundown.isActive" [color]="Color.RED" [animationDurationSeconds]="3"></sofie-pulsating-dot>
      </mat-cell>
    </ng-container>

    <ng-container matColumnDef="name">
      <mat-header-cell i18>rundown-overview-component.rundown-label</mat-header-cell>
      <mat-cell *matCellDef="let basicRundown" class="c-rundown-name" (click)="navigateToRundown(basicRundown)">
        {{basicRundown.name}}
      </mat-cell>
    </ng-container>

    <ng-container matColumnDef="modifiedAt">
      <mat-header-cell *matHeaderCellDef i18n>rundown-overview-component.last-updated.label</mat-header-cell>
      <mat-cell *matCellDef="let basicRundown">
        {{basicRundown.modifiedAt | date: 'HH:mm â€“ d LLL YYYY'}}
      </mat-cell>
    </ng-container>

    <ng-container matColumnDef="delete">
      <mat-header-cell *matHeaderCellDef></mat-header-cell>
      <mat-cell class="c-delete-rundown-cell" *matCellDef="let basicRundown">
        <sofie-icon-button class="material-icons c-delete-rundown-icon" [iconButton]="IconButton.DELETE" [iconButtonSize]="IconButtonSize.S" (click)="openDeletionDialog(basicRundown)"></sofie-icon-button>
      </mat-cell>
    </ng-container>

    <mat-header-row *matHeaderRowDef="['status', 'name', 'modifiedAt', 'delete']"></mat-header-row>
    <mat-row *matRowDef="let basicRundown; columns: ['status','name', 'modifiedAt', 'delete']"></mat-row>
  </table>
</ng-template>
